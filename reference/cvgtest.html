<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Unconditional and Conditional Coverage Tests, Independence Test — cvgtest • quarks</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Unconditional and Conditional Coverage Tests, Independence Test — cvgtest"><meta property="og:description" content="The conditional (Kupiec, 1995), the unconditional coverage
test (Christoffersen, 1998) and the independence test (Christoffersen, 1998)
of the Value-at-Risk (VaR) are applied."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quarks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Unconditional and Conditional Coverage Tests, Independence Test</h1>
    
    <div class="hidden name"><code>cvgtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The conditional (Kupiec, 1995), the unconditional coverage
test (Christoffersen, 1998) and the independence test (Christoffersen, 1998)
of the Value-at-Risk (VaR) are applied.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">cvgtest</span><span class="op">(</span>obj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>loss <span class="op">=</span> <span class="cn">NULL</span>, VaR <span class="op">=</span> <span class="cn">NULL</span>, p <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>, conflvl <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>a list that contains the following elements:</p><dl><dt><code>loss</code></dt>
<dd><p>a numeric vector that contains the values of a loss series
ordered from past to present; is set to <code>NULL</code> by default.</p></dd>

<dt><code>VaR</code></dt>
<dd><p>a numeric vector that contains the estimated values of the
VaR for the same time points of the loss series <code>loss</code>;
is set to <code>NULL</code> by default.</p></dd>

<dt><code>p</code></dt>
<dd><p>a numeric vector with one element; defines the probability p
stated in the null hypotheses of the coverage tests (see the section
<code>Details</code> for more information); is set to <code>NULL</code> by default.</p></dd>


</dl></dd>


<dt>conflvl</dt>
<dd><p>a numeric vector with one element; the significance
level at which the null hypotheses are evaluated; is set to <code>0.95</code> by
default.
Please note that a list returned by the <code>rollcast</code> function can be directly
passed to <code>cvgtest</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of class <code>quarks</code> with the following four elements:</p><dl><dt>p</dt>
<dd><p>probability p stated in the null hypotheses of the coverage tests</p></dd>

<dt>p.uc</dt>
<dd><p>the p-value of the unconditional coverage test</p></dd>

<dt>p.cc</dt>
<dd><p>the p-value of the conditional coverage test</p></dd>

<dt>p.ind</dt>
<dd><p>the p-value of the independence test</p></dd>

<dt>conflvl</dt>
<dd><p>the significance level at which the null hypotheses are
evaluated</p></dd>

<dt>model</dt>
<dd><p>selected model for estimation; only available if a list
returned by the <code>rollcast</code> function is passed to <code>cvgtest</code></p></dd>

<dt>method</dt>
<dd><p>selected method for estimation; only available if a list
returned by the <code>rollcast</code>) function is passed to <code>cvgtest</code></p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>With this function, the conditional and the unconditional coverage
tests introduced by Kupiec (1995) and Christoffersen (1998) can be applied.
Given a return series \(r_t\) with \(n\) observations, divide the
series into \(n-K\) in-sample and \(K\) out-of-sample observations,
fit a model to the in-sample data and obtain rolling one-step forecasts of
the VaR for the out-of-sample time points.</p>
<p>Define</p>
<p>$$I_t = 1,$$</p>
<p>if \(-r_t &gt; \widehat{VaR}_t (\alpha)\) or</p>
<p>$$I_t = 0,$$ otherwise,</p>
<p>for \(t = n + 1, n + 2, ..., n + K\) as the hit sequence, where \(\alpha\) is
the confidence level for the VaR (often \(\alpha = 0.95\) or \(\alpha = 0.99\)).
Furthermore, denote \(p = \alpha\) and let \(w\) be the actual covered
proportion of losses in the data.</p>
<p>1. Unconditional coverage test:</p>
<p>$$H_{0, uc}: p = w$$</p>
<p>Let \(K_1\) be the number of ones in \(I_t\) and analogously \(K_0\) the number of
zeros (all conditional on the first observation).
Also calculate \(\hat{w} = K_0 / (K - 1)\). Obtain</p>
<p>$$L(I_t, p) = p^{K_0}(1 - p)^{K_1}$$</p>
<p>and</p>
<p>$$L(I_t, \hat{w}) = \hat{w}^{K_0}(1 - \hat{w})^{K_1}$$</p>
<p>and subsequently the test statistic</p>
<p>$$LR_{uc} = -2  * \ln \{L(I_t, p) / L(I_t, \hat{w})\}.$$</p>
<p>\(LR_{uc}\) now asymptotically follows a chi-square-distribution with one degree
of freedom.</p>
<p>2. Conditional coverage test:</p>
<p>The conditional coverage test combines the unconditional coverage test
with a test on independence. Denote by \(w_{ij}\) the probability of an \(i\) on day
\(t-1\) being followed by a \(j\) on day \(t\), where \(i\) and \(j\) correspond to the value of
\(I_t\) on the respective day.</p>
<p>$$H_{0, cc}: w_{00} = w{10} = p$$</p>
<p>with \(i = 0, 1\) and \(j = 0, 1\).</p>
<p>Let \(K_{ij}\) be the number of observations, where the values on two following days
follow the pattern \(ij\). Calculate</p>
<p>$$L(I_t, \hat{w}_{00}, \hat{w}_{10})
= \hat{w}_{00}^{K_{00}}(1 - \hat{w}_{00})^{K_{01}} * \hat{w}_{10})^{K_{10}}(1 - \hat{w}_{10})^{K_{11}},$$</p>
<p>where \(\hat{w}_{00} = K_{00} / K_0\) and \(\hat{w}_{10} = K_{10} / K_1\). The test
statistic is then given by</p>
<p>$$LR_{cc} = -2  * \ln \{ L(I_t, p) / L(I_t, \hat{w}_{00}, \hat{w}_{10}) \},$$</p>
<p>which asymptotically follows a chi-square-distribution with two degrees of
freedom.</p>
<p>3. Independence test:</p>
<p>$$H_{0,ind}: w_{00} = w_{10}$$</p>
<p>The asymptotically chi-square-distributed test statistic (one degree of
freedom) is given by</p>
<p>$$LR_{ind} = -2  * \ln \{L(I_t, \hat{w}_{00}, \hat{w}_{10}) / L(I_t, \hat{w})\}.$$</p>
<p>-----------------------------------------------------------------------------</p>
<p>The function needs four inputs: the out-of-sample loss series <code>obj$loss</code>, the
corresponding estimated VaR series <code>obj$VaR</code>, the coverage level <code>obj$p</code>,
for which the VaR has been calculated and the significance level <code>conflvl</code>,
at which the null hypotheses are evaluated. If an object returned by this
function is entered into the R console, a detailed overview of the test results
is printed.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Christoffersen, P. F. (1998). Evaluating interval forecasts. International
economic review, pp. 841-862.</p>
<p>Kupiec, P. (1995). Techniques for verifying the accuracy of risk measurement
models. The J. of Derivatives, 3(2).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">prices</span> <span class="op">&lt;-</span> <span class="va">DAX</span><span class="op">$</span><span class="va">price.close</span></span>
<span class="r-in"><span class="va">returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">returns</span><span class="op">)</span></span>
<span class="r-in"><span class="va">nout</span> <span class="op">&lt;-</span> <span class="fl">250</span> <span class="co"># number of obs. for out-of-sample forecasting</span></span>
<span class="r-in"><span class="va">nwin</span> <span class="op">&lt;-</span> <span class="fl">500</span> <span class="co"># window size for rolling forecasts</span></span>
<span class="r-in"><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="rollcast.html">rollcast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">returns</span>, p <span class="op">=</span> <span class="fl">0.975</span>, method <span class="op">=</span> <span class="st">'age'</span>, nout <span class="op">=</span> <span class="va">nout</span>,</span>
<span class="r-in">                     nwin <span class="op">=</span> <span class="va">nwin</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculations completed.</span>
<span class="r-in"><span class="fu">cvgtest</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |               Test results               |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method: Age Weighting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model:  EWMA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |        Unconditional coverage test       |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: w = 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p_[uc] = 0.3296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decision: Fail to reject H0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |            Independence test             |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: w_[00] = w_[10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p_[ind] = 0.6865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decision: Fail to reject H0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |         Conditional coverage test        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: w_[00] = w_[10] = 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p_[cc] = 0.5731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decision: Fail to reject H0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Letmathe.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

